action: fire-dom-event
browser_mod:
  service: browser_mod.popup
  data:
    title: Thermostat du bureau
    size: fullscreen
    timeout: 500000
    style: >
      --ha-card-border-radius: 0;
    content:
      type: vertical-stack
      cards:

          - type: custom:simple-thermostat
            entity: climate.wiser_bureau
            style: |
              ha-card {
                --st-font-size-sensors: 20px;
                --st-spacing: 2px;
                --st-mode-active-background: var(--highlight-color)
              }
            header: false
            step_size: 0.5
            sensors:
              - attribute: current_humidity
                name: Humidité
                unit: "%"
              - attribute: boost_time_remaining
                name: 'Boost - temps restant'
                unit: "min"
            control:
              hvac:
                auto: false
                heat: 
                  name: Activé
                "off": true
              preset:
                Advance Schedule: false
                Cancel Overrides:
                  name: Annuler boost
                  icon: mdi:fire-off
                Boost 30m:
                  icon: mdi:fire
                Boost 1h:
                  icon: mdi:fire
                Boost 2h:
                  icon: mdi:fire
                Boost 3h:
                  icon: mdi:fire

          - type: custom:apexcharts-card
            apex_config:
              chart:
                height: 375px
                fontFamily: var(--primary-font-family)
              tooltip:
                style:
                  fontSize: 14px
                x:
                  show: true
                  format: dddd HH:mm
            show:
              last_updated: true
            graph_span: 3d
            locale: fr
            header:
              show: false
            all_series_config:
                stroke_width: 1
                unit: °C
            header:
              show: false
              title: Historique des températures
              show_states: true
              colorize_states: true
            yaxis:
              - min : '|-1|'
                decimals: 1
                opposite: true
                apex_config:
                  tickAmount: 4
                  labels:
                    formatter: |
                      EVAL:v => `${v.toFixed(0)} °C`
            color_list: [var(--fourth-color), var(--fifth-color)]
            series:
              - entity: sensor.wiser_lts_temperature_bureau
                type: line
                name: Température actuelle
                group_by:
                  duration: 30min
                  func: avg

              - entity: sensor.wiser_lts_target_temperature_bureau
                type: column
                opacity: 0.2
                name: Température cible
                group_by:
                  duration: 30min
                  func: avg

          # - type: custom:scheduler-card
          #   title: Planifications liées
          #   tags: [salon, chauffage]
          #   show_add_button: false
          #   discover_existing: false
